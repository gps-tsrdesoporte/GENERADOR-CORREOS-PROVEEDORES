<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador Correos para TSR SOPORTE - MAPFRE</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #070606;
            --bg-secondary: #1a1a1a;
            --bg-card: #2d2d2d;
            --bg-card-hover: #363636;
            --accent-primary: #E44E59;
            --accent-secondary: #c73d47;
            --accent-light: #f06570;
            --text-primary: #ffffff;
            --text-secondary: #b8b8b8;
            --border-color: #404040;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            background-image: radial-gradient(circle at 20% 30%, rgba(228, 78, 89, 0.06) 0%, transparent 50%),
                              radial-gradient(circle at 80% 70%, rgba(199, 61, 71, 0.05) 0%, transparent 50%);
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        header { text-align: center; margin-bottom: 3rem; padding: 2rem 0; border-bottom: 2px solid var(--border-color); position: relative; }
        header::after {
            content: ''; position: absolute; bottom: -2px; left: 50%; transform: translateX(-50%);
            width: 200px; height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        h1 {
            font-size: 3rem; font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-light));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 0.5rem; letter-spacing: -1px;
        }
        .subtitle { color: var(--text-secondary); font-size: 1.1rem; font-weight: 300; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .card {
            background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px;
            padding: 1.5rem; transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            transform: scaleX(0); transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-4px); border-color: var(--accent-primary);
            background: var(--bg-card-hover); box-shadow: 0 8px 24px rgba(228, 78, 89, 0.2);
        }
        .card:hover::before { transform: scaleX(1); }
        .card-title {
            font-size: 1.25rem; font-weight: 600; color: #ffffff;
            margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;
        }
        .card-title::before { content: 'â—†'; font-size: 0.8rem; color: var(--accent-primary); }
        .card-description { font-size: 1.05rem; color: #ffffff; margin-bottom: 1rem; line-height: 1.6; }
        .btn {
            width: 100%; padding: 0.875rem 1.5rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: #ffffff; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease; font-family: 'Outfit', sans-serif;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .btn:hover {
            transform: translateY(-2px); box-shadow: 0 6px 20px rgba(228, 78, 89, 0.4);
            background: linear-gradient(135deg, var(--accent-light), var(--accent-primary));
        }
        .btn:active { transform: translateY(0); }
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(10, 14, 26, 0.95); backdrop-filter: blur(10px);
            z-index: 1000; animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: var(--bg-card); border: 1px solid var(--accent-primary);
            border-radius: 16px; padding: 2rem; max-width: 700px; width: 90%;
            max-height: 85vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(228, 78, 89, 0.25);
            animation: slideUp 0.4s ease;
        }
        @keyframes slideUp { from { opacity: 0; transform: translate(-50%, -45%); } to { opacity: 1; transform: translate(-50%, -50%); } }
        .modal-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color);
        }
        .modal-title { font-size: 1.6rem; font-weight: 600; color: #ffffff; }
        .close-btn {
            background: none; border: none; color: var(--text-secondary);
            font-size: 1.5rem; cursor: pointer; transition: color 0.3s ease;
            width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
        }
        .close-btn:hover { color: var(--accent-primary); }
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; margin-bottom: 0.5rem; color: #ffffff; font-weight: 500; font-size: 1rem; }
        .form-input, .form-textarea {
            width: 100%; padding: 0.875rem; background: var(--bg-secondary);
            border: 1px solid var(--border-color); border-radius: 8px; color: #ffffff;
            font-family: 'Outfit', sans-serif; font-size: 1rem; transition: all 0.3s ease;
        }
        .form-input option { background: var(--bg-secondary); color: #ffffff; padding: 0.5rem; }
        .form-input:focus, .form-textarea:focus {
            outline: none; border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(228, 78, 89, 0.15);
        }
        .form-textarea { min-height: 120px; resize: vertical; }
        .email-preview {
            background: var(--bg-secondary); border: 1px solid var(--border-color);
            border-radius: 8px; padding: 1.5rem; margin-top: 1.5rem;
            font-family: 'IBM Plex Mono', monospace; font-size: 0.95rem;
            line-height: 1.8; color: #ffffff;
        }
        .email-preview strong { color: var(--accent-primary); }
        .btn-secondary { background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); }
        .btn-secondary:hover { background: var(--bg-primary); border-color: var(--accent-primary); }
        .button-group { display: flex; gap: 1rem; margin-top: 1.5rem; }
        .button-group .btn { flex: 1; }
        .info-banner {
            background: linear-gradient(135deg, rgba(228, 78, 89, 0.12), rgba(199, 61, 71, 0.08));
            border: 1px solid var(--accent-primary); border-radius: 8px; padding: 1rem;
            margin-bottom: 1.5rem; font-size: 1rem; color: #ffffff;
        }
        .info-banner strong { color: var(--accent-primary); }
        @media (max-width: 768px) {
            .grid { grid-template-columns: 1fr; }
            h1 { font-size: 2rem; }
            .modal-content { width: 95%; padding: 1.5rem; }
            .button-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Generador de correos para TSR SOPORTE</h1>
            <p class="subtitle">Sistema de gestiÃ³n de plantillas para <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a5d1d6d7c1c0d6cad5cad7d1c0e5c8c4d5c3d7c08bc6cac8">[email&#160;protected]</a></p>
        </header>
        <div class="grid" id="cardsContainer"></div>
    </div>
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"></h2>
                <button class="close-btn" onclick="closeModal()">Ã—</button>
            </div>
            <div id="modalBody"></div>
        </div>
    </div>
<script>
const templates = [
    {
        id: 1,
        title: "Dudas TÃ©cnicas / Coberturas",
        description: "Cuestiones relacionadas con coberturas y aplicaciÃ³n de las garantÃ­as contratadas. Asesoramiento tÃ©cnico. Para autorizaciones de LN/ RX o cuestiones tÃ©cnicas especÃ­ficas desde vivienda asegurada realiza videollamada.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "expediente", label: "NÃºmero de expediente", type: "text", required: true },
            { name: "duda", label: "DescripciÃ³n de la duda tÃ©cnica", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] Consulta TÃ©cnica - Expediente ${data.expediente}

Estimado equipo de TSR Soporte,

Me pongo en contacto con vosotros para realizar una consulta tÃ©cnica sobre cobertura.

NÂº Profesional/NIF: ${data.numProfesional}
Expediente: ${data.expediente}

Consulta:
${data.duda}

Quedo a la espera de vuestra respuesta.

Saludos cordiales.`
    },
    {
        id: 2,
        title: "Solicitud alta/baja",
        description: "Para cese temporal de actividad. DÃ­a de alta / baja siempre laborales. Comprueba si estÃ¡s de guardia e informa. EnvÃ­a a tu TSR un mensaje o ponle en copia en este mail.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "tipo", label: "Tipo de solicitud", type: "select", options: ["Alta", "Baja"], required: true },
            { name: "fechaInicio", label: "Fecha de inicio", type: "date", required: true },
            { name: "fechaFin", label: "Fecha de fin", type: "date", required: false },
            { name: "motivo", label: "Motivo", type: "select", options: ["Motivos Personales",  "Enfermedad/Accidente", "SaturaciÃ³n", "Cambio de RazÃ³n Social", "Sin VehÃ­culo", "Fin de ColaboraciÃ³n/jubilaciÃ³n"], required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] Solicitud de ${data.tipo} - Cese temporal de actividad

Estimado equipo de TSR Soporte,

Solicito tramitar una ${data.tipo.toLowerCase()}.

NÂº Profesional/NIF: ${data.numProfesional}
Fecha laboral de inicio: ${data.fechaInicio}
${data.fechaFin ? `Fecha laboral de fin: ${data.fechaFin}` : 'Fecha de fin: A determinar'}

Motivo: ${data.motivo}

Quedo a la espera de confirmaciÃ³n.

Saludos cordiales.`
    },
    {
        id: 3,
        title: "Incidencias en importes / facturaciones / embargos",
        description: "Posibles errores, incidencias en tus devoluciones relacionadas con importes o aplicaciÃ³n de tarifas. Incidencias en facturaciones y sus pagos. Consultas de estado de embargos.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "tipoIncidencia", label: "Tipo de incidencia", type: "select", options: ["Error en importe", "FacturaciÃ³n incorrecta", "Consulta embargo", "DevoluciÃ³n","Otra consulta"], required: true },
            { name: "numeroFactura", label: "NÃºmero de factura / NÂº expediente", type: "text", required: false },
            { name: "descripcion", label: "DescripciÃ³n detallada", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] Incidencia - ${data.tipoIncidencia}

Estimado equipo de TSR Soporte,

Me pongo en contacto para reportar una incidencia:

NÂº Profesional/NIF: ${data.numProfesional}
Tipo: ${data.tipoIncidencia}
${data.numeroFactura ? `Referencia: ${data.numeroFactura}` : ''}

DescripciÃ³n:
${data.descripcion}

Agradezco vuestra pronta atenciÃ³n.

Saludos cordiales.`
    },
    {
        id: 4,
        title: "GestiÃ³n de servicios",
        description: "Servicios mal cerrados o por error. RecuperaciÃ³n servicios pendiente de cliente. Recordad que deben intentar contactar antes con BGP (BaterÃ­a GestiÃ³n Proveedores 918 366 128 / 675 948 365)",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "numeroExpediente", label: "NÃºmero de expediente", type: "text", required: true },
            { name: "tipoGestion", label: "Tipo de gestiÃ³n", type: "select", options: ["Servicio mal cerrado", "RecuperaciÃ³n pendiente"], required: true },
            { name: "detalles", label: "Detalles del servicio", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] GestiÃ³n de Servicio - Expediente ${data.numeroExpediente}

Estimado equipo de TSR Soporte,

Solicito gestiÃ³n del siguiente servicio:

NÂº Profesional/NIF: ${data.numProfesional}
Expediente: ${data.numeroExpediente}
Tipo: ${data.tipoGestion}

Detalles:
${data.detalles}

Quedo pendiente de vuestra gestiÃ³n.

Saludos cordiales.`
    },
    {
        id: 5,
        title: "Modificar Datos Personales",
        description: "MantÃ©n actualizados tus datos. Recuerda que para datos telefÃ³nicos hay un nÃºmero mÃ³vil general (tambiÃ©n es el de urgencias por Whatsapp), tfno. para urgencias laborales de 8 a 19 y tfno para guardia (laborales de 19 a 8, fines de semana y festivos).",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "datosActualizar", label: "Datos a actualizar", type: "select", options: ["TelÃ©fono", "Email", "DirecciÃ³n", "Cuenta bancaria", "Varios"], required: true },
            { name: "datosNuevos", label: "Nuevos datos", type: "textarea", required: true },
            { name: "certificado", label: "Certificado titularidad banco (OBLIGATORIO si es Cuenta bancaria)", type: "select", options: ["SÃ­, adjunto", "No aplica"], required: false }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] ModificaciÃ³n de Datos Personales

Estimado equipo de TSR Soporte,

Solicito la actualizaciÃ³n de mis datos personales:

NÂº Profesional/NIF: ${data.numProfesional}
Datos a modificar: ${data.datosActualizar}

Nuevos datos:
${data.datosNuevos}

${data.certificado && data.certificado === "SÃ­, adjunto" ? `Certificado de titularidad bancaria: Adjunto` : ''}

Gracias por vuestra gestiÃ³n.

Saludos cordiales.`
    },
    {
        id: 6,
        title: "Cambiar una guardia",
        description: "Salvo que sea inminente y de causa inexcusable no se pueden llevar a cabo cambios sin informar previamente a tu TSR. Recuerda que los cambios se aplican a la semana completa.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "fechaInicio", label: "Fecha inicio guardia", type: "date", required: true },
            { name: "fechaFin", label: "Fecha fin guardia", type: "date", required: true },
            { name: "actividades", label: "Actividades", type: "text", required: true },
            { name: "zonas", label: "Zonas", type: "text", required: true },
            { name: "sustituto", label: "Sustituto propuesto", type: "text", required: true },
            { name: "motivo", label: "Motivo del cambio", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] Solicitud de Cambio de Guardia

Estimado equipo de TSR Soporte,

Solicito cambio de guardia con los siguientes datos:

NÂº Profesional/NIF: ${data.numProfesional}
PerÃ­odo original: Del ${data.fechaInicio} al ${data.fechaFin}
Actividades: ${data.actividades}
Zonas: ${data.zonas}
Sustituto propuesto: ${data.sustituto}

Motivo:
${data.motivo}

Quedo pendiente de confirmaciÃ³n.

Saludos cordiales.`
    },
    {
        id: 7,
        title: "Consulta uso o Incidencia Appcol/Infocol",
        description: "Ante problemas de acceso o funcionamiento, contacta primero con el SAU (915814900) y comunica la incidencia. Si es de Appcol, envÃ­a los LOGS (accede en ajustes, versiÃ³n). Para agilizar la resoluciÃ³n, indica el nÃºmero SD que te darÃ¡ el SAU junto con la descripciÃ³n del problema.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "tipoConsulta", label: "Tipo", type: "select", options: ["Incidencia Appcol", "Incidencia Infocol", "Consulta de uso", "Baja usuario / nuuma"], required: true },
            { name: "numeroSAU", label: "NÃºmero SD del SAU (imprescindible)", type: "text", required: true },
            { name: "descripcionProblema", label: "DescripciÃ³n del problema", type: "textarea", required: true },
            { name: "logsEnviados", label: "Â¿Has enviado LOGS? (si es Appcol)", type: "select", options: ["SÃ­", "No", "No aplica"], required: false }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] ${data.tipoConsulta} - NÃºmero SD: ${data.numeroSAU}

Estimado equipo de TSR Soporte,

Reporto la siguiente incidencia:

NÂº Profesional/NIF: ${data.numProfesional}
Tipo: ${data.tipoConsulta}
NÃºmero SD del SAU: ${data.numeroSAU}
${data.logsEnviados && data.logsEnviados !== "No aplica" ? `LOGS enviados: ${data.logsEnviados}` : ''}

DescripciÃ³n del problema:
${data.descripcionProblema}


Quedo a la espera de vuestra ayuda.

Saludos cordiales.`
    },
    {
        id: 8,
        title: "RotulaciÃ³n vehÃ­culo/CarnÃ©s, Puentes/Incidencias compra ropa",
        description: "Para solicitar rotulaciÃ³n es imprescindible que el vehÃ­culo sea blanco, estÃ© en buen estado y asegurado en MAPFRE/ VERTI (adjuntar pÃ³liza y recibo)",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "tipoSolicitud", label: "Tipo de solicitud", type: "select", options: ["RotulaciÃ³n vehÃ­culo", "CarnÃ©s", "Puentes", "Compra ropa"], required: true },
            { name: "detalles", label: "Detalles de la solicitud", type: "textarea", required: true },
            { name: "vehiculoBlanco", label: "VehÃ­culo blanco (si aplica)", type: "select", options: ["SÃ­", "No", "No aplica"], required: false },
            { name: "buenEstado", label: "Buen estado (si aplica)", type: "select", options: ["SÃ­", "No", "No aplica"], required: false },
            { name: "seguroAdjunto", label: "Â¿Adjuntas pÃ³liza y recibo? (si aplica)", type: "select", options: ["SÃ­", "No", "No aplica"], required: false }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] Solicitud - ${data.tipoSolicitud}

Estimado equipo de TSR Soporte,

Solicito gestiÃ³n de:

NÂº Profesional/NIF: ${data.numProfesional}
Tipo: ${data.tipoSolicitud}

${data.vehiculoBlanco && data.vehiculoBlanco !== "No aplica" ? `VehÃ­culo blanco: ${data.vehiculoBlanco}` : ''}
${data.buenEstado && data.buenEstado !== "No aplica" ? `Buen estado: ${data.buenEstado}` : ''}
${data.seguroAdjunto && data.seguroAdjunto !== "No aplica" ? `DocumentaciÃ³n adjunta: ${data.seguroAdjunto}` : ''}

Detalles:
${data.detalles}

Gracias por vuestra atenciÃ³n.

Saludos cordiales.`
    },
    {
        id: 9,
        title: "GestiÃ³n de documentaciÃ³n CAE/PRL - 6Conecta",
        description: "Si son problemas de acceso entra en www. 6conecta.com. Si tienes dudas de uso te recomendamos solicitar la guÃ­a y video. Si tienes incidencia con la validaciÃ³n de un documento revisa motivos en el documento en la pestaÃ±a CAMBIOS",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "tipoGestion", label: "Tipo de gestiÃ³n", type: "select", options: ["Problema de acceso", "Solicito guÃ­a y video", "Duda de uso", "ValidaciÃ³n/rechazo de documentos", "Otra incidencia"], required: true },
            { name: "descripcion", label: "DescripciÃ³n", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] GestiÃ³n DocumentaciÃ³n - ${data.tipoGestion}

Estimado equipo de TSR Soporte,

Necesito ayuda con la gestiÃ³n de documentaciÃ³n:

NÂº Profesional/NIF: ${data.numProfesional}
Tipo: ${data.tipoGestion}

DescripciÃ³n:
${data.descripcion}

${data.tipoGestion === "Problema de acceso" ? "He verificado el acceso a www.6conecta.com previamente." : ""}

Agradezco vuestra asistencia.

Saludos cordiales.`
    },
    {
        id: 10,
        title: "Tu experiencia nos importa",
        description: "Este espacio estÃ¡ pensado para que compartas tus comentarios sobre la atenciÃ³n recibida. Tu opiniÃ³n nos ayuda a mejorar nuestros servicios y ofrecerte una mejor experiencia.Si has tenido alguna incidencia con BaterÃ­a de Profesionales, TramitaciÃ³n o TSR informa. Es imprescindible dÃ­a / hora aproximada, el departamento y nombre de la persona que te ha atendido.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "fecha", label: "Fecha de la incidencia", type: "date", required: true },
            { name: "hora", label: "Hora aproximada", type: "time", required: true },
            { name: "nombrePersona", label: "Nombre y departamento de quien atendiÃ³", type: "text", required: true },
            { name: "descripcion", label: "DescripciÃ³n de la incidencia", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] Tu experiencia nos importa

Estimado equipo de TSR Soporte,

Les informo que:

NÂº Profesional/NIF: ${data.numProfesional}
Fecha: ${data.fecha}
Hora: ${data.hora}
Nombre y departamento de quien te atendiÃ³: ${data.nombrePersona}

DescripciÃ³n:
${data.descripcion}

Gracias por vuestra atenciÃ³n en la mejora del servicio.

Saludos cordiales.`
    },
    {
        id: 11,
        title: "Cliente solicita reenvÃ­o del presupuesto ofertado",
        description: "Si un cliente reclama presupuesto nos lo puedes solicitar, recuerda incluir el nÂº de expediente",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "numeroExpediente", label: "NÃºmero de expediente", type: "text", required: true },
            { name: "nombreCliente", label: "Nombre del cliente", type: "text", required: true },
            { name: "emailCliente", label: "Email del cliente", type: "email", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] ReenvÃ­o de Presupuesto - Expediente ${data.numeroExpediente}

Estimado equipo de TSR Soporte,

El cliente solicita reenvÃ­o del presupuesto ofertado:

NÂº Profesional/NIF: ${data.numProfesional}
Expediente: ${data.numeroExpediente}
Cliente: ${data.nombreCliente}
Email: ${data.emailCliente}

Agradezco el reenvÃ­o a la mayor brevedad.

Saludos cordiales.`
    },
    {
        id: 12,
        title: "Otros",
        description: "Este supuesto solo lo debes usar cuando ninguno de los anteriores encaja en lo que precisas. Debe ser muy expecional.",
        fields: [
            { name: "numProfesional", label: "NÂº Profesional o NIF", type: "text", required: true },
            { name: "asunto", label: "Asunto", type: "text", required: true },
            { name: "mensaje", label: "Mensaje detallado", type: "textarea", required: true }
        ],
        emailTemplate: (data) => `Asunto: [${data.numProfesional}] ${data.asunto}

Estimado equipo de TSR Soporte,

NÂº Profesional/NIF: ${data.numProfesional}

${data.mensaje}

Saludos cordiales.`
    }
];

function createCards() {
    const container = document.getElementById('cardsContainer');
    templates.forEach(template => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="card-title">${template.title}</div>
            <div class="card-description">${template.description}</div>
            <button class="btn" onclick="openModal(${template.id})">Generar Email</button>
        `;
        container.appendChild(card);
    });
}

function openModal(templateId) {
    const template = templates.find(t => t.id === templateId);
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    modalTitle.textContent = template.title;
    
    let formHTML = `<div id="emailPreview" style="margin-bottom: 2rem;"></div>`;
    formHTML += `<div class="info-banner"><strong>InformaciÃ³n:</strong> ${template.description}</div><form id="emailForm" onsubmit="generateEmail(event, ${templateId})">`;
    template.fields.forEach(field => {
        formHTML += `<div class="form-group"><label class="form-label">${field.label}${field.required ? ' *' : ''}</label>`;
        if (field.type === 'textarea') {
            formHTML += `<textarea class="form-textarea" name="${field.name}" ${field.required ? 'required' : ''}></textarea>`;
        } else if (field.type === 'select') {
            formHTML += `<select class="form-input" name="${field.name}" ${field.required ? 'required' : ''}><option value="">Selecciona una opciÃ³n</option>`;
            field.options.forEach(opt => { formHTML += `<option value="${opt}">${opt}</option>`; });
            formHTML += `</select>`;
        } else {
            formHTML += `<input type="${field.type}" class="form-input" name="${field.name}" ${field.required ? 'required' : ''}>`;
        }
        formHTML += `</div>`;
    });
    formHTML += `<div class="button-group"><button type="submit" class="btn">Generar Email</button><button type="button" class="btn btn-secondary" onclick="closeModal()">Cancelar</button></div></form>`;
    modalBody.innerHTML = formHTML;
    modal.style.display = 'block';
}

function closeModal() { document.getElementById('modal').style.display = 'none'; }

function generateEmail(event, templateId) {
    event.preventDefault();
    const template = templates.find(t => t.id === templateId);
    const form = event.target;
    const formData = new FormData(form);
    const data = {};
    for (let [key, value] of formData.entries()) { data[key] = value; }
    if (templateId === 5 && data.datosActualizar === "Cuenta bancaria") {
        if (!data.certificado || data.certificado === "No aplica") {
            alert('ATENCIÃ“N: Para modificar Cuenta bancaria es OBLIGATORIO adjuntar el Certificado de titularidad bancaria. Por favor, selecciona "SÃ­, adjunto".');
            return;
        }
    }
    const emailContent = template.emailTemplate(data);
    const previewDiv = document.getElementById('emailPreview');
    
    const emailHTML = emailContent.replace(/\n/g, '<br>');
    const encodedEmail = encodeURIComponent(emailContent);
    
    let previewHTML = '';
    previewHTML += '<div style="background: linear-gradient(135deg, rgba(228, 78, 89, 0.15), rgba(199, 61, 71, 0.1)); border: 2px solid #E44E59; border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;">';
    previewHTML += '<h3 style="color: #E44E59; margin-bottom: 1rem; font-size: 1.4rem;">âœ“ Email Generado - Vista Previa</h3>';
    previewHTML += '<div class="email-preview" style="margin-bottom: 1rem;">' + emailHTML + '</div>';
    previewHTML += '<div class="button-group">';
    previewHTML += '<button type="button" class="btn" onclick="sendEmailNow(\'' + encodedEmail + '\')">ðŸ“§ Abrir en cliente de correo</button>';
    previewHTML += '<button type="button" class="btn btn-secondary" onclick="copyEmailNow()">ðŸ“‹ Copiar al portapapeles</button>';
    previewHTML += '</div></div>';
    
    previewDiv.innerHTML = previewHTML;
    
    // Store email for copy function
    window.currentEmail = emailContent;
    
    const modalContent = document.querySelector('.modal-content');
    if (modalContent) {
        modalContent.scrollTop = 0;
    }
}

function sendEmail(encodedContent) {
    const content = decodeURIComponent(encodedContent);
    const subject = content.split('\n')[0].replace('Asunto: ', '');
    const body = content.split('\n').slice(2).join('\n');
    const mailtoLink = 'mailto:tsrdesoporte@mapfre.com?subject=' + encodeURIComponent(subject) + '&body=' + encodeURIComponent(body);
    window.location.href = mailtoLink;
}

function sendEmailNow(encodedContent) {
    sendEmail(encodedContent);
}

function copyEmailNow() {
    const text = window.currentEmail;
    if (!text) {
        alert('No hay email para copiar');
        return;
    }
    
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    
    try {
        document.execCommand('copy');
        alert('Email copiado al portapapeles correctamente');
    } catch (err) {
        console.error('Error al copiar:', err);
        
        if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(function() {
                alert('Email copiado al portapapeles');
            }).catch(function(err) {
                alert('No se pudo copiar al portapapeles');
            });
        } else {
            alert('No se pudo copiar al portapapeles');
        }
    }
    
    document.body.removeChild(textarea);
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => { alert('Email copiado al portapapeles'); }).catch(err => { console.error('Error al copiar:', err); });
}

window.onclick = function(event) {
    const modal = document.getElementById('modal');
    if (event.target === modal) { closeModal(); }
}

document.addEventListener('DOMContentLoaded', createCards);
</script>
</body>
</html>
